<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公務車管理系統</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10" integrity="sha384-D1Kt99CQMDuVetoL1lrYwg5t+9QdHe7NLX/SoJYkXDFfX37iInKRy5xLSi8nO7UC" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css" rel="stylesheet">
</head>
<body class="bg-gray-100">

    <header class="bg-white shadow-md">
        <div class="container mx-auto px-4 py-6">
            <h1 class="text-3xl font-bold text-gray-800">公務車管理系統</h1>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8 flex space-x-6">
        
        <nav class="w-1/4">
            <div class="bg-white shadow-md rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4">選單</h2>
                <ul class="space-y-2">
                    <li>
                        <a href="#" 
                           class="block px-4 py-2 rounded text-gray-700 hover:bg-blue-100 hover:text-blue-600 font-bold"
                           hx-get="/dashboard" hx-target="#main-content"
                           hx-swap="innerHTML"
                           hx-trigger="load, click" > 儀表板
                        </a>
                    </li>

                    <li>
                        <a href="#" 
                           class="block px-4 py-2 rounded text-gray-700 hover:bg-blue-100 hover:text-blue-600"
                           hx-get="/vehicle-management" hx-target="#main-content"
                           hx-swap="innerHTML"
                           
                           hx-trigger="load, click" >
                          車輛管理
                        </a>
                    </li>
                    <li>
                        <a href="#" 
                           class="block px-4 py-2 rounded text-gray-700 hover:bg-blue-100 hover:text-blue-600"
                           hx-get="/employee-management" hx-target="#main-content"
                           hx-swap="innerHTML"
                           >
                          員工管理
                        </a>
                    </li>
                    <li>
                        <a href="#" 
                        class="block px-4 py-2 rounded text-gray-700 hover:bg-blue-100 hover:text-blue-600"
                        hx-get="/maintenance-management"
                        hx-target="#main-content"
                        hx-swap="innerHTML"
                        >
                        保養管理 (全)
                        </a>
                    </li>
                    <li>
                        <a href="#" 
                        class="block px-4 py-2 rounded text-gray-700 hover:bg-blue-100 hover:text-blue-600"
                        hx-get="/inspection-management"
                        hx-target="#main-content"
                        hx-swap="innerHTML"
                        >
                        檢驗管理 (全)
                        </a>
                    </li>
                    <li>
                        <a href="#" 
                        class="block px-4 py-2 rounded text-gray-700 hover:bg-blue-100 hover:text-blue-600"
                        hx-get="/fee-management"
                        hx-target="#main-content"
                        hx-swap="innerHTML"
                        >
                        費用管理 (全)
                        </a>
                    </li>                    
                    </ul>
            </div>
        </nav>

        <main class="w-3/4">
            <div id="main-content">
                <p>正在載入...</p>
            </div>
        </main>
    
    </div> 
    
    <div id="modal-container"></div>
    <script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>

<script>
      // 封裝一個啟動函式
      function initializeTomSelect(element) {
        // 檢查它是否是 .searchable-select 且尚未被啟動
        if (element.classList.contains('searchable-select') && !element.tomselect) {
          
          new TomSelect(element, {
            create: false, // 不允許使用者新增選項
            sortField: {
              field: "text",
              direction: "asc"
            },

            // (!!!) 這裡是「支援中文搜尋」的關鍵程式碼 (!!!)
            // 我們覆蓋 Tom-Select 的評分(score)函式
            score: function(search) {
              // 取得預設的評分函式 (雖然我們不用它)
              var score = this.getScoreFunction(search);
              
              return function(item) {
                // 如果 search (搜尋文字) 是空的，顯示所有項目
                if (search.length === 0) return 1;

                // 檢查 item.text (選項文字) 是否「包含」 search (搜尋文字)
                // 'indexOf' > -1 意思就是「包含」
                // 這能讓我們用 "大明" 搜到 "王大明 / 0912..."
                return (item.text.toLowerCase().indexOf(search.toLowerCase()) > -1) ? 1 : 0;
              };
            }
            // (!!!) 中文搜尋程式碼結束 (!!!)

          });
        }
      }

      // 監聽 HTMX 載入內容的事件
      document.body.addEventListener('htmx:afterOnLoad', function(event) {
        // 啟動載入的根元素 (如果它自己就是 select)
        initializeTomSelect(event.detail.elt);
        
        // 啟動載入的內容中所有的 .searchable-select
        event.detail.elt.querySelectorAll('.searchable-select').forEach(initializeTomSelect);
      });
      
      // 也啟動頁面上已經存在的 .searchable-select (例如用在篩選器上)
      document.querySelectorAll('.searchable-select').forEach(initializeTomSelect);

    </script>

</body>
</html>