<div class="overflow-x-auto bg-white border border-gray-200 rounded-lg shadow-md">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-100">
      <tr>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">收到單據日</th>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">請款人</th>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">費用類型</th>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">關聯車輛</th>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">金額</th>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">已請款</th>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">發票號碼</th>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">備註/項目</th>
        <th class="px-3 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider">操作</th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      {% if not fee_records %}
        <tr>
          <td colspan="9" class="px-4 py-4 text-center text-sm text-gray-500">
            尚無費用紀錄
          </td>
        </tr>
      {% endif %} 

      {% for record in fee_records %}
      <tr class="hover:bg-gray-50 text-sm">
        <td class="px-3 py-3 whitespace-nowrap text-gray-900">
          {{ record.receive_date.strftime('%Y-%m-%d') if record.receive_date else 'N/A' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700">
          {{ record.user.name if record.user else 'N/A' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700">
          {{ fee_type_map.get(record.fee_type.value, record.fee_type.value) }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap font-medium text-blue-600">
          {{ record.vehicle.plate_no if record.vehicle else 'N/A' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 text-right">
          {{ "NT$ {:,.0f}".format(record.amount) if record.amount else 'N/A' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 text-center">
          {{ "✔️" if record.is_paid else "❌" }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700">
          {{ record.invoice_number or '' }}
        </td>
        <td class="px-3 py-3 text-gray-700 truncate" style="max-width: 200px;">
          {{ record.notes or '' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-right font-medium">
          <button
            class="text-blue-600 hover:text-blue-900"
            hx-get="/fee/{{ record.id }}/edit"
            hx-target="#modal-container"
            hx-swap="beforeend"
          >
            編輯
          </button>
          <button
            class="text-red-600 hover:text-red-900 ml-2"
            hx-delete="/fee/{{ record.id }}/delete"
            hx-target="closest tr"
            hx-swap="outerHTML"
            hx-confirm="確定要刪除這筆費用紀錄嗎？"
          >
            刪除
          </button>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>