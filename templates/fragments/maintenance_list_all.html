<div class="overflow-x-auto bg-white border border-gray-200 rounded-lg shadow-md">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-100">
      <tr>
        
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">æ“ä½œ</th>
        
        <th 
          class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider cursor-pointer"
          hx-get="/maintenance-list-all"
          hx-vals='{
            "filter_vehicle_id": "{{ query_params.get("filter_vehicle_id", "") }}",
            "filter_user_id": "{{ query_params.get("filter_user_id", "") }}",
            "filter_category": "{{ query_params.get("filter_category", "") }}",
            "sort_by": "vehicle_id",
            "sort_order": "{% if current_sort_by == "vehicle_id" and current_sort_order == "asc" %}desc{% else %}asc{% endif %}"
          }'
          hx-target="#maintenance-list-container" hx-swap="innerHTML"
        >
          è»Šè¼›
          {% if current_sort_by == "vehicle_id" %}{{ "ğŸ”¼" if current_sort_order == "asc" else "ğŸ”½" }}{% endif %}
        </th>
        
        <th 
          class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider cursor-pointer"
          hx-get="/maintenance-list-all"
          hx-vals='{
            "filter_vehicle_id": "{{ query_params.get("filter_vehicle_id", "") }}",
            "filter_user_id": "{{ query_params.get("filter_user_id", "") }}",
            "filter_category": "{{ query_params.get("filter_category", "") }}",
            "sort_by": "performed_on",
            "sort_order": "{% if current_sort_by == "performed_on" and current_sort_order == "asc" %}desc{% else %}asc{% endif %}"
          }'
          hx-target="#maintenance-list-container" hx-swap="innerHTML"
        >
          åŸ·è¡Œæ—¥æœŸ
          {% if current_sort_by == "performed_on" %}{{ "ğŸ”¼" if current_sort_order == "asc" else "ğŸ”½" }}{% endif %}
        </th>
        
        <th 
          class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider cursor-pointer"
          hx-get="/maintenance-list-all"
          hx-vals='{
            "filter_vehicle_id": "{{ query_params.get("filter_vehicle_id", "") }}",
            "filter_user_id": "{{ query_params.get("filter_user_id", "") }}",
            "filter_category": "{{ query_params.get("filter_category", "") }}",
            "sort_by": "category",
            "sort_order": "{% if current_sort_by == "category" and current_sort_order == "asc" %}desc{% else %}asc{% endif %}"
          }'
          hx-target="#maintenance-list-container" hx-swap="innerHTML"
        >
          é¡åˆ¥
          {% if current_sort_by == "category" %}{{ "ğŸ”¼" if current_sort_order == "asc" else "ğŸ”½" }}{% endif %}
        </th>

        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">ç•¶æ™‚é‡Œç¨‹</th>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">ç•¶æ™‚ä½¿ç”¨äºº</th>
        
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">ç‰½è»Š(å›)æ—¥æœŸ</th>
        
        <th 
          class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider cursor-pointer"
          hx-get="/maintenance-list-all"
          hx-vals='{
            "filter_vehicle_id": "{{ query_params.get("filter_vehicle_id", "") }}",
            "filter_user_id": "{{ query_params.get("filter_user_id", "") }}",
            "filter_category": "{{ query_params.get("filter_category", "") }}",
            "sort_by": "service_target_km",
            "sort_order": "{% if current_sort_by == "service_target_km" and current_sort_order == "asc" %}desc{% else %}asc{% endif %}"
          }'
          hx-target="#maintenance-list-container" hx-swap="innerHTML"
        >
          ä¿é¤Šé‡Œç¨‹
          {% if current_sort_by == "service_target_km" %}{{ "ğŸ”¼" if current_sort_order == "asc" else "ğŸ”½" }}{% endif %}
        </th>
      </tr>
    </thead>
    
    <tbody class="bg-white divide-y divide-gray-200">
      {% if not maintenance_records %}
        <tr>
          <td colspan="8" class="px-4 py-4 text-center text-sm text-gray-500">
            å°šç„¡ä¿é¤Šç¶­ä¿®ç´€éŒ„
          </td>
        </tr>
      {% endif %} 

      {% for record in maintenance_records %}
      <tr class="hover:bg-gray-50 text-sm">
        
        <td class="px-3 py-3 whitespace-nowrap text-left font-medium">
          <button
            class="text-green-600 hover:text-green-900"
            hx-get="/attachments/manage/maintenance/{{ record.id }}"
            hx-target="#modal-container"
            hx-swap="beforeend"
            title="é™„ä»¶"
          >
            é™„ä»¶
          </button>
          <button
            class="text-blue-600 hover:text-blue-900 ml-2"
            hx-get="/maintenance/{{ record.id }}/edit"
            hx-target="#modal-container"
            hx-swap="beforeend"
          >
            ç·¨è¼¯
          </button>
          <button
            class="text-red-600 hover:text-red-900 ml-2"
            hx-delete="/maintenance/{{ record.id }}/delete"
            hx-target="closest tr"
            hx-swap="outerHTML"
            hx-confirm="ç¢ºå®šè¦åˆªé™¤é€™ç­†ä¿é¤Šç´€éŒ„å—ï¼Ÿ"
          >
            åˆªé™¤
          </button>
        </td>

        <td class="px-3 py-3 whitespace-nowrap font-medium text-blue-600 cursor-pointer" hx-get="/maintenance/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.vehicle.plate_no if record.vehicle else '' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-900 cursor-pointer" hx-get="/maintenance/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.performed_on.strftime('%Y-%m-%d') if record.performed_on else '' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 cursor-pointer" hx-get="/maintenance/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ maintenance_category_map.get(record.category.value, record.category.value) }}
        </td>
        
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 text-right cursor-pointer" hx-get="/maintenance/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ "{:,.0f} km".format(record.odometer_km) if record.odometer_km else '' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 cursor-pointer" hx-get="/maintenance/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.user.name if record.user else '' }}
        </td>

        <td class="px-3 py-3 whitespace-nowrap text-gray-700 cursor-pointer" hx-get="/maintenance/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.return_date.strftime('%Y-%m-%d') if record.return_date else '' }}
        </td>
        
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 text-right cursor-pointer" hx-get="/maintenance/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ "{:,.0f} km".format(record.service_target_km) if record.service_target_km else '' }}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>