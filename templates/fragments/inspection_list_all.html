<div class="overflow-x-auto bg-white border border-gray-200 rounded-lg shadow-md">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-100">
      <tr>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">æ“ä½œ</th>
        
        <th 
          class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider cursor-pointer"
          hx-get="/inspection-list-all"
          hx-vals='{
            "filter_vehicle_id": "{{ query_params.get("filter_vehicle_id", "") }}",
            "filter_notify_start": "{{ query_params.get("filter_notify_start", "") }}",
            "filter_notify_end": "{{ query_params.get("filter_notify_end", "") }}",
            "filter_deadline_start": "{{ query_params.get("filter_deadline_start", "") }}",
            "filter_deadline_end": "{{ query_params.get("filter_deadline_end", "") }}",
            "sort_by": "vehicle_id",
            "sort_order": "{% if current_sort_by == "vehicle_id" and current_sort_order == "asc" %}desc{% else %}asc{% endif %}"
          }'
          hx-target="#inspection-list-container" hx-swap="innerHTML"
        >
          è»Šè¼›
          {% if current_sort_by == "vehicle_id" %}{{ "ğŸ”¼" if current_sort_order == "asc" else "ğŸ”½" }}{% endif %}
        </th>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">
          ç•¶æ™‚ä½¿ç”¨äºº
        </th>        
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">æª¢é©—é¡å‹</th>
        
        <th 
          class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider cursor-pointer"
          hx-get="/inspection-list-all"
          hx-vals='{
            "filter_vehicle_id": "{{ query_params.get("filter_vehicle_id", "") }}",
            "filter_notify_start": "{{ query_params.get("filter_notify_start", "") }}",
            "filter_notify_end": "{{ query_params.get("filter_notify_end", "") }}",
            "filter_deadline_start": "{{ query_params.get("filter_deadline_start", "") }}",
            "filter_deadline_end": "{{ query_params.get("filter_deadline_end", "") }}",
            "sort_by": "inspected_on",
            "sort_order": "{% if current_sort_by == "inspected_on" and current_sort_order == "asc" %}desc{% else %}asc{% endif %}"
          }'
          hx-target="#inspection-list-container" hx-swap="innerHTML"
        >
          å¯¦éš›é©—è»Šæ—¥
          {% if current_sort_by == "inspected_on" %}{{ "ğŸ”¼" if current_sort_order == "asc" else "ğŸ”½" }}{% endif %}
        </th>
        
        <th 
          class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider cursor-pointer"
          hx-get="/inspection-list-all"
          hx-vals='{
            "filter_vehicle_id": "{{ query_params.get("filter_vehicle_id", "") }}",
            "filter_notify_start": "{{ query_params.get("filter_notify_start", "") }}",
            "filter_notify_end": "{{ query_params.get("filter_notify_end", "") }}",
            "filter_deadline_start": "{{ query_params.get("filter_deadline_start", "") }}",
            "filter_deadline_end": "{{ query_params.get("filter_deadline_end", "") }}",
            "sort_by": "next_due_on",
            "sort_order": "{% if current_sort_by == "next_due_on" and current_sort_order == "asc" %}desc{% else %}asc{% endif %}"
          }'
          hx-target="#inspection-list-container" hx-swap="innerHTML"
        >
          ä¸‹æ¬¡æ‡‰é©—æ—¥
          {% if current_sort_by == "next_due_on" %}{{ "ğŸ”¼" if current_sort_order == "asc" else "ğŸ”½" }}{% endif %}
        </th>
        
        <th 
          class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider cursor-pointer"
          hx-get="/inspection-list-all"
          hx-vals='{
            "filter_vehicle_id": "{{ query_params.get("filter_vehicle_id", "") }}",
            "filter_notify_start": "{{ query_params.get("filter_notify_start", "") }}",
            "filter_notify_end": "{{ query_params.get("filter_notify_end", "") }}",
            "filter_deadline_start": "{{ query_params.get("filter_deadline_start", "") }}",
            "filter_deadline_end": "{{ query_params.get("filter_deadline_end", "") }}",
            "sort_by": "amount",
            "sort_order": "{% if current_sort_by == "amount" and current_sort_order == "asc" %}desc{% else %}asc{% endif %}"
          }'
          hx-target="#inspection-list-container" hx-swap="innerHTML"
        >
          é‡‘é¡
          {% if current_sort_by == "amount" %}{{ "ğŸ”¼" if current_sort_order == "asc" else "ğŸ”½" }}{% endif %}
        </th>
        
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">å·²å°å¸³</th>
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">ç¶“æ‰‹äºº</th>
        
        <th 
          class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider cursor-pointer"
          hx-get="/inspection-list-all"
          hx-vals='{
            "filter_vehicle_id": "{{ query_params.get("filter_vehicle_id", "") }}",
            "filter_notify_start": "{{ query_params.get("filter_notify_start", "") }}",
            "filter_notify_end": "{{ query_params.get("filter_notify_end", "") }}",
            "filter_deadline_start": "{{ query_params.get("filter_deadline_start", "") }}",
            "filter_deadline_end": "{{ query_params.get("filter_deadline_end", "") }}",
            "sort_by": "notification_date",
            "sort_order": "{% if current_sort_by == "notification_date" and current_sort_order == "asc" %}desc{% else %}asc{% endif %}"
          }'
          hx-target="#inspection-list-container" hx-swap="innerHTML"
        >
          é€šçŸ¥æ—¥æœŸ
          {% if current_sort_by == "notification_date" %}{{ "ğŸ”¼" if current_sort_order == "asc" else "ğŸ”½" }}{% endif %}
        </th>
        
        <th 
          class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider cursor-pointer"
          hx-get="/inspection-list-all"
          hx-vals='{
            "filter_vehicle_id": "{{ query_params.get("filter_vehicle_id", "") }}",
            "filter_notify_start": "{{ query_params.get("filter_notify_start", "") }}",
            "filter_notify_end": "{{ query_params.get("filter_notify_end", "") }}",
            "filter_deadline_start": "{{ query_params.get("filter_deadline_start", "") }}",
            "filter_deadline_end": "{{ query_params.get("filter_deadline_end", "") }}",
            "sort_by": "deadline_date",
            "sort_order": "{% if current_sort_by == "deadline_date" and current_sort_order == "asc" %}desc{% else %}asc{% endif %}"
          }'
          hx-target="#inspection-list-container" hx-swap="innerHTML"
        >
          æœŸé™
          {% if current_sort_by == "deadline_date" %}{{ "ğŸ”¼" if current_sort_order == "asc" else "ğŸ”½" }}{% endif %}
        </th>
        
        <th class="px-3 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">å‚™è¨»</th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      {% if not inspection_records %}
        <tr>
          <td colspan="12" class="px-4 py-4 text-center text-sm text-gray-500">
            å°šç„¡æª¢é©—ç´€éŒ„ (æˆ–æŸ¥ç„¡ç¬¦åˆæ¢ä»¶çš„ç´€éŒ„)
          </td>
        </tr>
      {% endif %} 
      
      {% for record in inspection_records %}
      <tr class="hover:bg-gray-50 text-sm">
        
        <td class="px-3 py-3 whitespace-nowrap text-left font-medium">
          <button
            class="text-green-600 hover:text-green-900"
            hx-get="/attachments/manage/inspection/{{ record.id }}"
            hx-target="#modal-container"
            hx-swap="beforeend"
            title="é™„ä»¶"
          >
            é™„ä»¶
          </button>
          <button
            class="text-blue-600 hover:text-blue-900 ml-2"
            hx-get="/inspection/{{ record.id }}/edit"
            hx-target="#modal-container"
            hx-swap="beforeend"
          >
            ç·¨è¼¯
          </button>
          <button
            class="text-red-600 hover:text-red-900 ml-2"
            hx-delete="/inspection/{{ record.id }}/delete"
            hx-target="closest tr"
            hx-swap="outerHTML"
            hx-confirm="ç¢ºå®šè¦åˆªé™¤é€™ç­†æª¢é©—ç´€éŒ„å—ï¼Ÿ"
          >
            åˆªé™¤
          </button>
        </td>

        <td class="px-3 py-3 whitespace-nowrap font-medium text-blue-600 cursor-pointer" hx-get="/inspection/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.vehicle.plate_no if record.vehicle else '' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 cursor-pointer" hx-get="/inspection/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.user.name if record.user else '' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 cursor-pointer" hx-get="/inspection/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ inspection_kind_map.get(record.kind.value, record.kind.value) }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-900 cursor-pointer" hx-get="/inspection/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.inspected_on.strftime('%Y-%m-%d') if record.inspected_on else '' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 cursor-pointer" hx-get="/inspection/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.next_due_on.strftime('%Y-%m-%d') if record.next_due_on else '' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 text-right cursor-pointer" hx-get="/inspection/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ "NT$ {:,.0f}".format(record.amount) if record.amount else '' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 text-center cursor-pointer" hx-get="/inspection/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ "âœ”ï¸" if record.is_reconciled else "âŒ" }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 cursor-pointer" hx-get="/inspection/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.handler.name if record.handler else '' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 cursor-pointer" hx-get="/inspection/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.notification_date.strftime('%Y-%m-%d') if record.notification_date else '' }}
        </td>
        <td class="px-3 py-3 whitespace-nowrap text-gray-700 cursor-pointer" hx-get="/inspection/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.deadline_date.strftime('%Y-%m-%d') if record.deadline_date else '' }}
        </td>
        <td class="px-3 py-3 text-gray-700 truncate cursor-pointer" style="max-width: 150px;" hx-get="/inspection/{{ record.id }}/edit" hx-target="#modal-container" hx-swap="beforeend">
          {{ record.notes or '' }}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>